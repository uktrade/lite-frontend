{"mappings":"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","sources":["core/assets/javascripts/cookie-banner.js","caseworker/assets/javascripts/cookie-policy-form.js"],"sourcesContent":["\"use strict\";\n\nfunction CookieBanner() {\n  var cookiePreferencesName = \"cookie_preferences_set\";\n  var cookiePreferencesDurationDays = 365;\n\n  var cookiesPolicyName = \"cookies_policy\";\n  var cookiesPolicyDurationDays = 365;\n\n  function setCookie(name, value, options) {\n    if (typeof options === \"undefined\") {\n      options = {};\n    }\n    var cookieString = name + \"=\" + value + \"; path=/\";\n    if (options.days) {\n      var date = new Date();\n      date.setTime(date.getTime() + options.days * 24 * 60 * 60 * 1000);\n      cookieString = cookieString + \"; expires=\" + date.toGMTString();\n    }\n    if (document.location.protocol === \"https:\") {\n      cookieString = cookieString + \"; Secure\";\n    }\n    document.cookie = cookieString;\n  }\n\n  function getCookie(name) {\n    var nameEQ = name + \"=\";\n    var cookies = document.cookie.split(\";\");\n    for (var i = 0, len = cookies.length; i < len; i++) {\n      var cookie = cookies[i];\n      while (cookie.charAt(0) === \" \") {\n        cookie = cookie.substring(1, cookie.length);\n      }\n      if (cookie.indexOf(nameEQ) === 0) {\n        return decodeURIComponent(cookie.substring(nameEQ.length));\n      }\n    }\n    return null;\n  }\n\n  function getDefaultPolicy() {\n    return {\n      essential: true,\n      settings: false,\n      usage: false,\n      campaigns: false,\n    };\n  }\n\n  function getPolicyOrDefault() {\n    var cookie = getCookie(cookiesPolicyName);\n    var policy = getDefaultPolicy();\n    if (!cookie) return policy;\n\n    try {\n      var parsed = JSON.parse(cookie);\n\n      policy.campaigns = parsed.campaigns || false;\n      policy.usage = parsed.usage || false;\n      policy.settings = parsed.settings || false;\n    } catch (e) {\n      return policy;\n    }\n\n    return policy;\n  }\n\n  function createPoliciesCookie(settings, usage, campaigns) {\n    var policy = getDefaultPolicy();\n    policy.settings = settings || false;\n    policy.usage = usage || false;\n    policy.campaigns = campaigns || false;\n    var json = JSON.stringify(policy);\n    setCookie(cookiesPolicyName, json, { days: cookiesPolicyDurationDays });\n    return policy;\n  }\n\n  function hideCookieBanner(className) {\n    var banner = document.querySelector(className);\n    banner.className = banner.className.replace(/app-cookie-banner--show/, \"\");\n  }\n\n  function displayCookieBannerAcceptAll(cookieBannerClassName) {\n    var banner = document.querySelector(cookieBannerClassName);\n    banner.className =\n      banner.className + \" app-cookie-banner--show__accepted-all\";\n\n    var hideButton = document.querySelector(\".hide-button\");\n    if (hideButton.attachEvent) {\n      hideButton.attachEvent(\"click\", function () {\n        hideCookieBanner(cookieBannerClassName);\n      });\n    } else {\n      hideButton.addEventListener(\n        \"click\",\n        function (e) {\n          hideCookieBanner(cookieBannerClassName);\n          e.preventDefault();\n          return false;\n        },\n        false\n      );\n    }\n  }\n\n  function displayCookieBanner(className) {\n    var banner = document.querySelector(className);\n\n    banner.className = banner.className.replace(\n      /js--cookie-banner/,\n      \"app-cookie-banner--show\"\n    );\n  }\n\n  function bindAcceptAllCookiesButton(className, onClickFunction) {\n    var button = document.querySelector(className);\n    if (button.attachEvent) {\n      button.attachEvent(\"onclick\", onClickFunction);\n    } else {\n      button.addEventListener(\"click\", onClickFunction, false);\n    }\n  }\n\n  function setPreferencesCookie() {\n    setCookie(cookiePreferencesName, \"true\", {\n      days: cookiePreferencesDurationDays,\n    });\n  }\n\n  function enableCookieBanner(bannerClassName, acceptButtonClassName) {\n    var banner = document.querySelector(bannerClassName);\n    if (!banner) {\n      return;\n    }\n    displayCookieBanner(bannerClassName);\n    bindAcceptAllCookiesButton(acceptButtonClassName, function () {\n      createPoliciesCookie(true, true, true);\n\n      setPreferencesCookie();\n      displayCookieBannerAcceptAll(bannerClassName);\n\n      return false;\n    });\n  }\n\n  function init(bannerClassName, acceptButtonClassName, cookiesPolicyUrl) {\n    if (!bannerClassName) {\n      throw \"Expected bannerClassName\";\n    }\n\n    var preferenceCookie = getCookie(cookiePreferencesName);\n    var isCookiesPage = document.URL.indexOf(cookiesPolicyUrl) !== -1;\n\n    if (!preferenceCookie && !isCookiesPage) {\n      enableCookieBanner(bannerClassName, acceptButtonClassName);\n    }\n  }\n\n  function bindCookiePolicyForm(\n    formSelector,\n    confirmationSelector,\n    radioButtons\n  ) {\n    if (typeof radioButtons !== \"object\") {\n      throw \"expected an object with radio button selectors\";\n    }\n\n    var form = document.querySelector(formSelector);\n\n    if (!form) {\n      throw formSelector + \" was not found\";\n    }\n\n    var confirmation = document.querySelector(confirmationSelector);\n    if (!confirmation) {\n      throw confirmationSelector + \" was not found\";\n    }\n\n    var policy = getPolicyOrDefault();\n\n    form[radioButtons.usage].value = policy.usage ? \"on\" : \"off\";\n    form[radioButtons.settings].value = policy.settings ? \"on\" : \"off\";\n    form[radioButtons.campaigns].value = policy.campaigns ? \"on\" : \"off\";\n\n    var attachEventMethod = form.attachEvent || form.addEventListener;\n    attachEventMethod(\n      \"submit\",\n      function (e) {\n        var settings = form[radioButtons.settings].value === \"on\";\n        var usage = form[radioButtons.usage].value === \"on\";\n        var campaigns = form[radioButtons.campaigns].value === \"on\";\n\n        createPoliciesCookie(settings, usage, campaigns);\n        setPreferencesCookie();\n\n        confirmation.style = \"display:block;\";\n        window.scrollTo(0, 0);\n\n        e.preventDefault();\n        return false;\n      },\n      false\n    );\n  }\n\n  return {\n    initBanner: init,\n    bindForm: bindCookiePolicyForm,\n  };\n}\n\nexport default CookieBanner;\n","import CookieBanner from \"../../../core/assets/javascripts/cookie-banner\";\n\nvar cookiePolicy = new CookieBanner();\ncookiePolicy.bindForm(\n  \"#cookie-preferences-form\",\n  \".cookie-settings__confirmation\",\n  {\n    usage: \"cookies-usage\",\n    campaigns: \"cookies-campaigns\",\n    settings: \"cookies-settings\",\n  }\n);\n"],"names":["setCookie","name","value","options","cookieString","days","date","Date","setTime","getTime","toGMTString","document","location","protocol","cookie","getCookie","nameEQ","cookies","split","i","len","length","charAt","substring","indexOf","decodeURIComponent","createPoliciesCookie","settings","usage","campaigns","policy","essential","json","JSON","stringify","cookiesPolicyName","cookiesPolicyDurationDays","hideCookieBanner","className","banner","querySelector","replace","setPreferencesCookie","cookiePreferencesName","cookiePreferencesDurationDays","enableCookieBanner","bannerClassName","acceptButtonClassName","onClickFunction","button","displayCookieBanner","cookieBannerClassName","hideButton","attachEvent","addEventListener","e","preventDefault","displayCookieBannerAcceptAll","initBanner","cookiesPolicyUrl","preferenceCookie","isCookiesPage","URL","bindForm","formSelector","confirmationSelector","radioButtons","form","confirmation","parsed","parse","getPolicyOrDefault","style","window","scrollTo"],"version":3,"file":"cookie-policy-form.js.map"}
