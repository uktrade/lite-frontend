!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function i(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function o(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||i(t)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l,u="Select all",c=function(){"use strict";function e(n,i){t(this,e),this.$selectAllButton=n,this.$checkboxes=i,this.isAllSelected=!1}return n(e,[{key:"init",value:function(){var t=this;this.$selectAllButton.addEventListener("click",(function(e){return t.handleSelectAllButtonClick(e)}));var e=!0,n=!1,i=void 0;try{for(var r,o=this.$checkboxes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.addEventListener("input",(function(){return t.setSelectAll()}))}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}this.setSelectAll()}},{key:"handleSelectAllButtonClick",value:function(t){t.preventDefault(),this.setCheckboxesChecked(!this.isAllSelected)}},{key:"setCheckboxesChecked",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,o=this.$checkboxes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;s.checked=t,s.dispatchEvent(new Event("input"))}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"getNumChecked",value:function(){var t=0,e=!0,n=!1,i=void 0;try{for(var r,o=this.$checkboxes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){t+=r.value.checked?1:0}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}return t}},{key:"setSelectAll",value:function(){this.getNumChecked()===this.$checkboxes.length?(this.$selectAllButton.textContent="Deselect all",this.isAllSelected=!0):(this.$selectAllButton.textContent=u,this.isAllSelected=!1)}}]),e}(),a="Show all",d=function(){"use strict";function e(n,i){t(this,e),this.$expandAllButton=n,this.$details=i,this.isAllExpanded=!1}return n(e,[{key:"init",value:function(){var t=this;this.$expandAllButton.addEventListener("click",(function(e){return t.handleExpandAllButtonClick(e)}));var e=!0,n=!1,i=void 0;try{for(var r,o=this.$details[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.addEventListener("toggle",(function(){return t.setExpandAll()}))}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}this.setExpandAll()}},{key:"handleExpandAllButtonClick",value:function(t){t.preventDefault(),this.setDetailsOpen(!this.isAllExpanded)}},{key:"setDetailsOpen",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,o=this.$details[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;s.open=t,s.dispatchEvent(new Event("toggle"))}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"getNumOpened",value:function(){var t=0,e=!0,n=!1,i=void 0;try{for(var r,o=this.$details[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){t+=r.value.open?1:0}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}return t}},{key:"setExpandAll",value:function(){this.getNumOpened()===this.$details.length?(this.$expandAllButton.textContent="Hide all",this.isAllExpanded=!0):(this.$expandAllButton.textContent=a,this.isAllExpanded=!1)}}]),e}(),h=function(){"use strict";function e(n,i,r){t(this,e),this.$checkboxes=n,this.$elementToToggleClass=i,this.toggleClass=r}return n(e,[{key:"init",value:function(){var t=this,e=!0,n=!1,i=void 0;try{for(var r,o=this.$checkboxes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.addEventListener("input",(function(e){return t.handleCheckboxInput(e)}))}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}this.setClass()}},{key:"handleCheckboxInput",value:function(){this.setClass()}},{key:"getNumChecked",value:function(){var t=0,e=!0,n=!1,i=void 0;try{for(var r,o=this.$checkboxes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){t+=r.value.checked?1:0}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}return t}},{key:"setClass",value:function(){var t=0===this.getNumChecked();this.$elementToToggleClass.classList.toggle(this.toggleClass,t)}}]),e}(),f=function(){"use strict";function e(n){t(this,e),this.$button=n}return n(e,[{key:"init",value:function(){var t=this;this.$button.addEventListener("click",(function(e){return t.handleClick(e)}))}},{key:"handleClick",value:function(){var t=this;setTimeout((function(){return t.$button.disabled=!0}),0)}}]),e}(),v=function(){"use strict";function e(n){t(this,e),this.$headline=n}return n(e,[{key:"getText",value:function(t){if(1===t.length){var e=t[0].name;return"Assessing ".concat(e)}return"Assessing ".concat(t.length," products")}},{key:"setProducts",value:function(t){this.$headline.textContent=this.getText(t)}}]),e}(),y=function(){"use strict";function e(n,i,r){t(this,e),this.$checkboxes=n,this.onSelectProducts=r,this.products={};var o=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var a=u.value;this.products[a.id]=a}}catch(t){s=!0,l=t}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}}return n(e,[{key:"init",value:function(){var t=this,e=!0,n=!1,i=void 0;try{for(var r,o=this.$checkboxes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.addEventListener("input",(function(){t.onSelectProducts(t.getSelectedProducts())}))}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}this.onSelectProducts(this.getSelectedProducts())}},{key:"getSelectedProducts",value:function(){var t=[],e=!0,n=!1,i=void 0;try{for(var r,o=this.$checkboxes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;s.checked&&t.push(this.products[s.value])}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}return t}}]),e}(),g=function(){"use strict";function e(){t(this,e),this.suggestions=[],this.seenExporterSuggestions=new Set,this.seenAssessedSuggestions=new Set}return n(e,[{key:"getSuggestionKey",value:function(t){return t.sort().join("|")}},{key:"addSuggestion",value:function(t,e,n){var i=this.getSuggestionKey(e);t.has(i)||(t.add(i),this.suggestions.push([e,n]))}},{key:"addExporterSuggestion",value:function(t,e){this.addSuggestion(this.seenExporterSuggestions,t,e)}},{key:"addAssessedSuggestion",value:function(t,e){this.addSuggestion(this.seenAssessedSuggestions,t,e)}}]),e}(),k=function(){"use strict";function e(n,i){t(this,e),this.$suggestionsContainer=n,this.onSelectSuggestions=i}return n(e,[{key:"getSuggestionButton",value:function(t){var e=document.createElement("button");return e.classList.add("lite-button--link"),e.textContent=t,e}},{key:"getSuggestionText",value:function(t){return t.join(", ")}},{key:"getExporterSuggestionText",value:function(t){var e=this.getSuggestionText(t);return"Select exporter suggestion ".concat(e)}},{key:"getAssessedSuggestionText",value:function(t){var e=this.getSuggestionText(t);return"Copy previous assessment ".concat(e)}},{key:"getSuggestions",value:function(t){var e=new g,n=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value.controlListEntries,u=l.exporter,c=l.precedents;u&&u.length>0&&e.addExporterSuggestion(u,this.getExporterSuggestionText(u));var a=!0,d=!1,h=void 0;if(c)try{for(var f,v=c[Symbol.iterator]();!(a=(f=v.next()).done);a=!0){var y=f.value;y.length&&e.addAssessedSuggestion(y,this.getAssessedSuggestionText(y))}}catch(t){d=!0,h=t}finally{try{a||null==v.return||v.return()}finally{if(d)throw h}}}}catch(t){i=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return e.suggestions}},{key:"setProducts",value:function(t){this.$suggestionsContainer.innerHTML="";var e=this.getSuggestions(t),n=!0,i=!1,r=void 0;try{for(var o,l=this,u=function(t,e){var n=s(e.value,2),i=n[0],r=n[1],o=l,u=l.getSuggestionButton(r);u.addEventListener("click",(function(t){return o.handleSuggestionButtonClick(t,i)})),l.$suggestionsContainer.append(u)},c=e[Symbol.iterator]();!(n=(o=c.next()).done);n=!0)u(0,o)}catch(t){i=!0,r=t}finally{try{n||null==c.return||c.return()}finally{if(i)throw r}}}},{key:"handleSuggestionButtonClick",value:function(t,e){t.preventDefault(),this.onSelectSuggestions(e)}}]),e}(),S=function(){"use strict";function e(n){t(this,e),this.controlListEntriesSelector=n}return n(e,[{key:"setSuggestions",value:function(t){document.querySelector(this.controlListEntriesSelector).tokenfield.addItems(t.map((function(t){return{id:t,name:t}})))}}]),e}(),m=function(){"use strict";function e(n,i){t(this,e),this.controlListEntriesSelector=n,this.$noControlListCheckbox=i}return n(e,[{key:"init",value:function(){var t=this;this.$noControlListCheckbox.addEventListener("input",(function(e){return t.handleNoControlListCheckboxInput(e)}))}},{key:"emptyTokenField",value:function(){document.querySelector(this.controlListEntriesSelector).tokenfield.emptyItems()}},{key:"displayNoCLEEntry",value:function(){var t=this,e=document.querySelector(this.controlListEntriesSelector);e.querySelector(".tokenfield-input").style.display="none";var n=e.querySelector(".tokenfield-set ul"),i=document.createElement("li");i.classList.add("tokenfield-set-item","tau-none-item");var r=document.createElement("span");r.classList.add("item-label"),r.textContent="None";var o=document.createElement("a");o.classList.add("item-remove"),o.tabIndex=-1,o.textContent="×",o.addEventListener("click",(function(){t.setCheckbox(!1)})),i.append(r,o),n.appendChild(i)}},{key:"removeNoCLEEntry",value:function(){var t=document.querySelector(this.controlListEntriesSelector);t.querySelector(".tokenfield-input").style.removeProperty("display");var e=t.querySelector(".tokenfield-set .tau-none-item");null==e||e.remove()}},{key:"handleNoControlListCheckboxInput",value:function(){this.$noControlListCheckbox.checked?(this.emptyTokenField(),this.displayNoCLEEntry()):this.removeNoCLEEntry()}},{key:"setCheckbox",value:function(t){this.$noControlListCheckbox.checked=t,this.$noControlListCheckbox.dispatchEvent(new Event("input"))}},{key:"reset",value:function(){this.setCheckbox(!1)}}]),e}();!function(){var t=document.querySelector("#div_id_goods");if(t){var e=function(t){var e=document.createElement("div");return e.classList.add("tau__first-column--options"),t.insertBefore(e,t.firstElementChild.nextElementSibling),e}(t),n=function(t){var e=document.createElement("button");e.innerText=u,e.classList.add("lite-button--link","tau__select-all");var n=t.querySelectorAll("[name=goods]");return new c(e,n).init(),e}(t),i=function(t){var e=document.createElement("button");e.innerText=a,e.classList.add("lite-button--link");var n=t.querySelectorAll(".govuk-details");return new d(e,n).init(),e}(t);e.append(n,i)}}(),function(){var t=document.querySelector("#div_id_goods");if(t){var e=t.querySelectorAll("[name=goods]"),n=document.querySelector(".tau__second-column");new h(e,n,"tau__second-column--hide").init()}}(),function(){var t=document.querySelector(".tau__headline"),e=new v(t),n=document.querySelector("[name=does_not_have_control_list_entries]"),i=new m("#control_list_entries",n);i.init();var r=new S("#control_list_entries"),o=document.querySelector(".tau__cle-suggestions"),s=new k(o,(function(t){r.setSuggestions(t),i.reset()})),l=document.querySelector("#div_id_goods").querySelectorAll("[name=goods]"),u=JSON.parse(document.querySelector("#cle-suggestions-json").textContent);new y(l,u,(function(t){e.setProducts(t),s.setProducts(t)})).init()}(),l=document.querySelector("#submit-id-submit"),new f(l).init()}();
//# sourceMappingURL=tau.js.map
